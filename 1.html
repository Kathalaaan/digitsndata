



<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SQL Challenge Playground ‚Äî Avengers Timeline Crisis</title>
   <link rel="icon" type="image/png" href="img/favicon2.png">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0a0f1c;
  --surface:#121a2a;
  --highlight:#4ee1a0;
  --error:#ff6584;
  --text:#e6f1ff;
  --muted:#98a1b3;
  --border:#1e2a3b;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Poppins',sans-serif;
  background:radial-gradient(circle at 25% 15%, #16213e 0%, #0a0f1c 100%);
  color:var(--text);
  min-height:100vh;
  display:flex;
  flex-direction:column;
}
header{
  background:rgba(255,255,255,0.02);
  backdrop-filter:blur(8px);
  border-bottom:1px solid var(--border);
  padding:18px 32px;
  display:flex;align-items:center;justify-content:space-between;
}
.logo{font-weight:700;font-size:1.2rem;color:var(--highlight)}
.title{font-size:0.9rem;color:var(--muted)}

main {
  flex: 1;
  display: grid;
  grid-template-columns: 1.2fr 1fr;
  grid-template-areas:
    "prob edit"
    "prob out";
  gap: 20px;
  padding: 24px 40px;
}

/* Assign each section to its grid-area */
.problem { grid-area: prob; }
.editor { grid-area: edit; }
.output { grid-area: out; }


.panel{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:16px;
  padding:20px;
  box-shadow:0 0 20px rgba(0,0,0,0.3);
}

.problem h2{color:var(--highlight);margin-bottom:12px;}
.problem p{line-height:1.6;font-size:0.95rem;margin-bottom:12px;}

textarea{
  width:100%;height:60vh;
  background:#0c1629;border:none;outline:none;border-radius:12px;
  color:var(--text);font-family:monospace;padding:14px;font-size:14px;
  line-height:1.5;resize:none;
}

.controls{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
button{
  background:var(--highlight);
  border:none;color:#000;font-weight:600;padding:10px 16px;
  border-radius:10px;cursor:pointer;transition:0.2s;
}
button:hover{transform:translateY(-2px);background:#6ef4b7}
button.secondary{background:transparent;border:1px solid var(--highlight);color:var(--highlight)}

.output h3{margin-bottom:10px;color:var(--highlight)}
table{width:100%;border-collapse:collapse;font-size:0.9rem}
th,td{padding:8px;border-bottom:1px solid var(--border);}
th{color:var(--highlight);text-align:left;}

.status{margin-top:14px;padding:12px 14px;border-radius:10px;font-weight:600;font-size:0.9rem}
.pass{background:rgba(78,225,160,0.1);color:var(--highlight);border:1px solid rgba(78,225,160,0.2)}
.fail{background:rgba(255,101,132,0.1);color:var(--error);border:1px solid rgba(255,101,132,0.2)}

#hintBox{
  display:none;
  margin-top:10px;
  padding:10px;
  border-left:3px solid var(--highlight);
  background:rgba(255,255,255,0.05);
  border-radius:8px;
  color:var(--muted);
}

#nextChallenge{
  display:none;
  background:#00ffb0;
  color:#000;
  font-weight:700;
  padding:12px 18px;
  border-radius:12px;
  margin-top:15px;
  cursor:pointer;
  border:none;
  transition:0.2s;
}
#nextChallenge:hover{background:#4ee1a0;transform:scale(1.05)}

footer{padding:12px 40px;text-align:center;color:var(--muted);font-size:0.8rem;border-top:1px solid var(--border)}

canvas#drawing_canvas{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  pointer-events:none;
  z-index:999;
}


@media(max-width:900px){
  main{
    grid-template-columns:1fr;
    grid-template-areas:
      "prob"
      "edit"
      "out";
    padding: 16px;
    gap: 14px;
  }

  textarea{
    height: 32vh;
    font-size: 13px;
  }

  .panel{
    padding:14px;
  }

  header, footer{
    padding:12px 14px;
    text-align:center;
  }

  table {
    display:block;
    overflow-x:auto;
  }
}
canvas#drawing_canvas {
  touch-action: none;
}
</style>
</head>
<body>
<header>
  <div class="logo">Digits n Data (SQL Playground)</div>
  <div class="title">Avengers Timeline Crisis ‚Äî Week 1</div>
</header>

<canvas id="drawing_canvas"></canvas>

<main>
  <section class="panel problem">
    <h2>Challenge</h2>
    <p id="problemText"></p>
  </section>

  <section class="panel editor">
    <h3 style="color:var(--highlight);margin-bottom:8px">Your SQL Query</h3>
    <textarea id="sql"></textarea>
    <div class="controls">
      <button id="run">Run Query</button>
      <button id="showHint" class="secondary">Hint üí°</button>
    </div>
    <div id="status" class="status" style="display:none"></div>
    <div id="hintBox"></div>
    <a href="2.html" id="nextChallenge" class="btn">Next Challenge ‚û°Ô∏è</a>
  </section>

  <section class="panel output">
    <h3>Query Output</h3>
    <div id="resultArea">Run your query to see results...</div>
  </section>
</main>

<footer>¬© 2025 Avengers SQL Timeline ‚Äî Week 1: The Roster Check</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js"></script>
<script>
const SQL = window.initSqlJs;
let db = null;
let currentChallenge = 0;


// =================== CHALLENGES ===================
const challenges = [
  {
   text: `<strong>Question 1: The Roster Check and The Ethereal Signal</strong><br><br>
<strong>The Crisis:</strong><br>
Something is wrong with time itself. Energy readings across the planet are spiking. Then‚Ä¶ Tony Stark‚Äôs A.I. returns, partially restored.<br><br>
<em>‚ÄúThe timeline is fracturing. We must assess who can still defend Earth.‚Äù</em><br><br>

Before planning any action, we need to verify which Avengers are still capable of deployment.<br><br>

<strong>Your Task:</strong><br>
Find how many <strong>Active Avengers</strong> have a <strong>Mission Success Rate</strong> higher than the team average AND are assigned to <strong>Primary Defense</strong>.<br><br>

<strong>Dataset:</strong> <code>Avengers_Roster</code><br><br>

<table style="border-collapse:collapse; width:100%; font-size:0.9rem; margin-top:10px;">
<thead>
<tr>
<th style="border-bottom:1px solid var(--border); padding:6px;">AvengerID</th>
<th style="border-bottom:1px solid var(--border); padding:6px;">Name</th>
<th style="border-bottom:1px solid var(--border); padding:6px;">Status</th>
<th style="border-bottom:1px solid var(--border); padding:6px;">MissionSuccessRate</th>
<th style="border-bottom:1px solid var(--border); padding:6px;">Assignment</th>
</tr>
</thead>
<tbody>
<tr><td>1</td><td>Iron Man</td><td>Deceased</td><td>95.4</td><td>Primary Defense</td></tr>
<tr><td>2</td><td>Captain America</td><td>Active</td><td>89.2</td><td>Primary Defense</td></tr>
<tr><td>3</td><td>Thor</td><td>Active</td><td>91.8</td><td>Primary Defense</td></tr>
<tr><td>4</td><td>Black Widow</td><td>Deceased</td><td>88.9</td><td>Support</td></tr>
<tr><td>5</td><td>Hawkeye</td><td>On Leave</td><td>79.3</td><td>Reserve</td></tr>
<tr><td>6</td><td>Hulk</td><td>Active</td><td>85.5</td><td>Primary Defense</td></tr>
<tr><td>7</td><td>Spider-Man</td><td>Active</td><td>93.1</td><td>Support</td></tr>
<tr><td>8</td><td>Doctor Strange</td><td>Active</td><td>97.7</td><td>Primary Defense</td></tr>
<tr><td>9</td><td>Wanda Maximoff</td><td>Active</td><td>92.6</td><td>Support</td></tr>
<tr><td>10</td><td>Falcon</td><td>Active</td><td>81.2</td><td>Primary Defense</td></tr>
</tbody>
</table>

<br>
<strong>The Result:</strong><br>
Return a single number ‚Üí this unlocks Question 2.`,

    expectedSQL: `
      SELECT COUNT(*) AS StrongDefenders
      FROM Avengers_Roster
      WHERE Status = 'Active'
      AND Assignment = 'Primary Defense'
      AND MissionSuccessRate > (
          SELECT AVG(MissionSuccessRate) FROM Avengers_Roster
      );
    `,
    defaultSQL: `SELECT COUNT(*) AS StrongDefenders
FROM Avengers_Roster
WHERE Status='Active' AND Assignment='Primary Defense'
AND MissionSuccessRate > (SELECT AVG(MissionSuccessRate) FROM Avengers_Roster);`
  }
];


const avengersData = `
CREATE TABLE Avengers_Roster(
  AvengerID INT,
  Name TEXT,
  Status TEXT,
  MissionSuccessRate FLOAT,
  Assignment TEXT
);
INSERT INTO Avengers_Roster VALUES
(1,'Iron Man','Deceased',95.4,'Primary Defense'),
(2,'Captain America','Active',89.2,'Primary Defense'),
(3,'Thor','Active',91.8,'Primary Defense'),
(4,'Black Widow','Deceased',88.9,'Support'),
(5,'Hawkeye','On Leave',79.3,'Reserve'),
(6,'Hulk','Active',85.5,'Primary Defense'),
(7,'Spider-Man','Active',93.1,'Support'),
(8,'Doctor Strange','Active',97.7,'Primary Defense'),
(9,'Wanda Maximoff','Active',92.6,'Support'),
(10,'Falcon','Active',81.2,'Primary Defense');
`;

const motivationalLines = [
  "üî• Amazing! You‚Äôve cracked it like a pro!",
  "üéØ Nailed it! Your SQL skills are shining!",
  "üåü Outstanding! You‚Äôre unstoppable!",
  "üöÄ Boom! That‚Äôs perfect SQL mastery!",
  "üí™ Great work! Keep the momentum going!"
];

function renderTable(rows, columns){
  if(rows.length===0)return'<div style="color:var(--muted)">No rows</div>';
  let html='<table><thead><tr>'+columns.map(c=>`<th>${c}</th>`).join('')+'</tr></thead><tbody>';
  rows.forEach(r=>html+='<tr>'+columns.map(c=>`<td>${r[c]}</td>`).join('')+'</tr>');
  return html+'</tbody></table>';
}

function toRows(result){
  if(!result)return{columns:[],rows:[]};
  const cols=result.columns,vals=result.values;
  const rows=vals.map(v=>Object.fromEntries(cols.map((c,i)=>[c,v[i]])));
  return{columns:cols,rows};
}

function showStatus(type,msg){
  const s=document.getElementById('status');
  s.style.display='block';
  s.className='status '+(type==='pass'?'pass':'fail');
  s.innerHTML=msg;
}

async function init(){
  const SQLjs=await SQL({ locateFile:f=>'https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/'+f });
  db=new SQLjs.Database();
  db.run(avengersData);
  loadChallenge(0);
  document.getElementById('run').onclick=runSQL;
  document.getElementById('showHint').onclick=showHint;
  document.getElementById('nextChallenge').onclick=nextChallenge;
}

function loadChallenge(index){
  currentChallenge=index;
  const challenge=challenges[index];
  document.getElementById('problemText').innerHTML=challenge.text;
  document.getElementById('sql').value=challenge.defaultSQL;
  const exp=db.exec(challenge.expectedSQL)[0];
  window._expected=toRows(exp);
  document.getElementById('resultArea').innerHTML="Run your query to see results...";
  document.getElementById('status').style.display="none";
  document.getElementById('hintBox').style.display="none";
  document.getElementById('nextChallenge').style.display="none";
}

function canonicalize(res){
  const cols=res.columns||[],rows=res.rows||[];
  return rows.map(r=>JSON.stringify(cols.map(c=>r[c]))).sort().join('\n');
}

function runSQL(){
  const code=document.getElementById('sql').value.trim();
  try{
    const r=db.exec(code);
    if(!r.length){document.getElementById('resultArea').innerHTML='<div style="color:var(--muted)">No rows returned.</div>';showStatus('fail','No rows returned.');return;}
    const o=toRows(r[0]);
    document.getElementById('resultArea').innerHTML=renderTable(o.rows,o.columns);
    const pass=canonicalize(o)===canonicalize(window._expected);
    if(pass){
      const line=motivationalLines[Math.floor(Math.random()*motivationalLines.length)];
      showStatus('pass','üéâ Correct Answer! '+line);
      startExplosion();
      document.getElementById('nextChallenge').style.display="block";
    }else{
      showStatus('fail','‚ùå Output mismatch, check logic.');
    }
  }catch(e){
    document.getElementById('resultArea').innerHTML='<pre style="color:#ff9b9b">'+e+'</pre>';
    showStatus('fail','SQL Error. Check syntax.');
  }
}

function showHint(){
  const box=document.getElementById("hintBox");
  box.innerHTML = `
  üí° <strong>Hint:</strong><br>
  1) Compute the <strong>average</strong> MissionSuccessRate first (use a subquery).<br>
  2) Filter only <strong>Active</strong> heroes in <strong>Primary Defense</strong>.<br>
  3) Compare their rate to the average.<br>
  4) Use <strong>COUNT(*)</strong> to return just the number.
  `;
  box.style.display="block";
}

function nextChallenge(){
  loadChallenge(currentChallenge + 1);
}

// EXPLOSION EFFECT
</script>

<!-- Explosion Code Stays Same -->
<script>
const TWO_PI=Math.PI*2;
let viewWidth=window.innerWidth,viewHeight=window.innerHeight;
const drawingCanvas=document.getElementById("drawing_canvas");
let ctx,timeStep=1/60,particles=[],active=false;
function Point(x,y){this.x=x||0;this.y=y||0;}
function Particle(p0,p1,p2,p3){this.p0=p0;this.p1=p1;this.p2=p2;this.p3=p3;
  this.time=0;this.duration=2+Math.random()*2;
  this.color='#'+Math.floor((Math.random()*0xffffff)).toString(16);
  this.w=8;this.h=6;this.complete=false;}
Particle.prototype={
  update:function(){this.time=Math.min(this.duration,this.time+timeStep);
    var f=Ease.outCubic(this.time,0,1,this.duration);
    var p=cubeBezier(this.p0,this.p1,this.p2,this.p3,f);
    this.x=p.x;this.y=p.y;this.complete=this.time===this.duration;},
  draw:function(){ctx.save();ctx.translate(this.x,this.y);
    ctx.fillStyle=this.color;ctx.fillRect(-this.w*0.5,-this.h*0.5,this.w,this.h);ctx.restore();}
};
function initDrawingCanvas(){drawingCanvas.width=viewWidth;drawingCanvas.height=viewHeight;ctx=drawingCanvas.getContext('2d');createParticles();}
function createParticles(){particles=[];for(var i=0;i<200;i++){var p0=new Point(viewWidth*0.5,viewHeight*0.5);var p1=new Point(Math.random()*viewWidth,Math.random()*viewHeight);var p2=new Point(Math.random()*viewWidth,Math.random()*viewHeight);var p3=new Point(Math.random()*viewWidth,viewHeight+64);particles.push(new Particle(p0,p1,p2,p3));}}
function update(){particles.forEach(p=>p.update());}
function draw(){ctx.clearRect(0,0,viewWidth,viewHeight);particles.forEach(p=>p.draw());}
function loop(){if(!active)return;update();draw();if(particles.every(p=>p.complete))active=false;requestAnimationFrame(loop);}
var Ease={outCubic:(t,b,c,d)=>{t/=d;t--;return c*(t*t*t+1)+b;}};function cubeBezier(p0,c0,c1,p1,t){var p=new Point();var nt=(1-t);p.x=nt*nt*nt*p0.x+3*nt*nt*t*c0.x+3*nt*t*t*c1.x+t*t*t*p1.x;p.y=nt*nt*nt*p0.y+3*nt*nt*t*c0.y+3*nt*t*t*c1.y+t*t*t*p1.y;return p;}
function startExplosion(){if(active)return;active=true;initDrawingCanvas();loop();}
window.addEventListener("resize",()=>{viewWidth=window.innerWidth;viewHeight=window.innerHeight;initDrawingCanvas();});
</script>

<script>init();</script>

</body>
</html>

